select customer.customer_name,customer.customer_city from customer Inner Join borrower on customer.customer_id=borrower.customer_id Inner join loan on borrower.loan_number=loan.loan_number where branch_name='Perryridge';
select distinct branch_name from branch where assets>any(select assets from branch where branch_city='Brooklyn');
select distinct branch_name from branch where assets>all (select assets from branch where branch_city='Horseneck');
select *from loan order by amount desc,loan_number;
select branch_name,balance from account group by branch_name having avg(balance)>=700;
select customer.customer_name,account.account_number  from customer Inner Join depositor on customer.customer_id=depositor.customer_id Inner join account on depositor.account_number=account.account_number order by account.balance desc limit 3;
select distinct customer.customer_name from customer Inner Join depositor on customer.customer_id=depositor.customer_id Inner join account on depositor.account_number=account.account_number where account.branch_name in (select account.branch_name from account Inner Join depositor on account.account_number=depositor.account_number Inner join customer on depositor.customer_id=customer.customer_id where customer.customer_name='Johnson')and customer.customer_name!='Johnson';
select customer.customer_name from customer Inner join depositor on customer.customer_id=depositor.customer_id Inner join account on depositor.account_number=account.account_number where branch_name ='Mianus' and customer.customer_id not in (select borrower.customer_id from borrower Inner join loan on loan.loan_number=borrower.loan_number where loan.branch_name='Mianus');
select branch_name,count(account_number) from account group by branch_name having count(account_number)>=1;
select avg(account.balance) from account Inner join depositor on account.account_number=depositor.account_number inner join customer on customer.customer_id=depositor.customer_id group by customer.customer_city having customer.customer_city='Palo Alto' and count(account.account_number)>=2;
select customer.customer_name,avg(account.balance) from account Inner join depositor on account.account_number=depositor.account_number inner join customer on customer.customer_id=depositor.customer_id where customer.customer_city='Palo Alto' group by customer.customer_id having count(customer.customer_id)>=2;